<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel - Cita Rasa Indonesia</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    --primary: #D32F2F;
    --primary-dark: #C62828;
    --secondary: #FFA726;
    --accent: #FF7043;
    --success: #4CAF50;
    --danger: #f44336;
    --bg: #f5f5f5;
    --white: #fff;
    --shadow: 0 2px 8px rgba(0,0,0,0.1);
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--bg);
    color: #333;
    line-height: 1.6;
}

/* Login Screen */
.login-container {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #FFF8E1 0%, #FFE0B2 100%);
    padding: 20px;
}

.login-box {
    background: var(--white);
    padding: 40px;
    border-radius: 16px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    width: 100%;
    max-width: 400px;
}

.login-logo {
    text-align: center;
    margin-bottom: 30px;
}

.login-logo img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    border: 3px solid var(--secondary);
    margin-bottom: 15px;
}

.login-logo h1 {
    font-size: 1.8em;
    color: var(--primary);
    margin-bottom: 8px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    font-weight: 600;
    margin-bottom: 8px;
    color: var(--primary);
}

.form-group input {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #FFE0B2;
    border-radius: 8px;
    font-size: 1em;
    font-family: inherit;
    transition: all 0.3s;
}

.form-group input:focus {
    outline: none;
    border-color: var(--secondary);
    box-shadow: 0 0 0 3px rgba(255, 167, 38, 0.1);
}

.login-btn {
    width: 100%;
    padding: 14px;
    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
    color: var(--white);
    border: none;
    border-radius: 8px;
    font-size: 1.1em;
    font-weight: 700;
    cursor: pointer;
    transition: transform 0.2s;
}

.login-btn:active {
    transform: scale(0.98);
}

.error-message {
    background: #ffebee;
    color: var(--danger);
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 20px;
    text-align: center;
    font-weight: 600;
    display: none;
}

.error-message.show {
    display: block;
}

/* Admin Dashboard */
.admin-container {
    display: none;
}

.admin-container.active {
    display: block;
}

.admin-header {
    background: var(--white);
    padding: 20px;
    box-shadow: var(--shadow);
    position: sticky;
    top: 0;
    z-index: 100;
}

.admin-header-content {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 15px;
}

.admin-title {
    font-size: 1.5em;
    color: var(--primary);
    font-weight: 800;
}

.admin-actions {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.btn {
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 0.95em;
}

.btn-primary {
    background: var(--primary);
    color: var(--white);
}

.btn-success {
    background: var(--success);
    color: var(--white);
}

.btn-secondary {
    background: var(--secondary);
    color: var(--white);
}

.btn-danger {
    background: var(--danger);
    color: var(--white);
}

.btn:hover {
    opacity: 0.9;
    transform: translateY(-2px);
}

.admin-content {
    max-width: 1400px;
    margin: 30px auto;
    padding: 0 20px;
}

.section-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 30px;
    overflow-x: auto;
    padding-bottom: 10px;
}

.tab-btn {
    padding: 12px 24px;
    background: var(--white);
    border: 2px solid #FFE0B2;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    white-space: nowrap;
}

.tab-btn.active {
    background: var(--primary);
    color: var(--white);
    border-color: var(--primary);
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

/* Menu Management */
.menu-category {
    background: var(--white);
    padding: 25px;
    border-radius: 12px;
    margin-bottom: 25px;
    box-shadow: var(--shadow);
}

.category-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 2px solid #FFE0B2;
}

.category-title {
    font-size: 1.4em;
    color: var(--primary);
    font-weight: 700;
}

.menu-items-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.menu-item-card {
    background: linear-gradient(135deg, #FFFBF5, #FFF8F0);
    padding: 20px;
    border-radius: 10px;
    border: 2px solid #FFE0B2;
}

.item-header {
    display: flex;
    justify-content: space-between;
    align-items: start;
    margin-bottom: 15px;
}

.item-name-price h4 {
    font-size: 1.1em;
    color: var(--primary);
    margin-bottom: 5px;
}

.item-price-tag {
    background: var(--primary);
    color: var(--white);
    padding: 4px 12px;
    border-radius: 20px;
    font-weight: 700;
    font-size: 0.9em;
}

.item-ingredients {
    margin: 15px 0;
    font-size: 0.9em;
    color: #666;
}

.item-actions {
    display: flex;
    gap: 8px;
    margin-top: 15px;
}

.btn-small {
    padding: 8px 16px;
    font-size: 0.85em;
    flex: 1;
}

/* Modal */
.modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    padding: 20px;
    overflow-y: auto;
}

.modal.active {
    display: flex;
}

.modal-content {
    background: var(--white);
    padding: 30px;
    border-radius: 16px;
    width: 100%;
    max-width: 600px;
    max-height: 90vh;
    overflow-y: auto;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 2px solid #FFE0B2;
}

.modal-header h2 {
    font-size: 1.5em;
    color: var(--primary);
}

.close-modal {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: none;
    background: #ffebee;
    color: var(--danger);
    font-size: 1.5em;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.form-grid {
    display: grid;
    gap: 20px;
}

.form-group textarea {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #FFE0B2;
    border-radius: 8px;
    font-size: 1em;
    font-family: inherit;
    min-height: 100px;
    resize: vertical;
}

.form-group textarea:focus {
    outline: none;
    border-color: var(--secondary);
}

.ingredients-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.ingredient-item {
    display: flex;
    gap: 10px;
    align-items: center;
}

.ingredient-item input {
    flex: 1;
}

.btn-icon {
    width: 40px;
    height: 40px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2em;
}

.form-actions {
    display: flex;
    gap: 12px;
    margin-top: 25px;
}

.form-actions .btn {
    flex: 1;
    padding: 14px;
}

/* Image Management */
.image-section {
    background: var(--white);
    padding: 25px;
    border-radius: 12px;
    margin-bottom: 25px;
    box-shadow: var(--shadow);
}

.image-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.image-card {
    background: #f5f5f5;
    border-radius: 10px;
    overflow: hidden;
    border: 2px solid #FFE0B2;
}

.image-preview {
    width: 100%;
    aspect-ratio: 1;
    object-fit: cover;
}

.image-info {
    padding: 15px;
}

.image-url {
    font-size: 0.85em;
    color: #666;
    word-break: break-all;
    margin-bottom: 10px;
}

.image-actions {
    display: flex;
    gap: 8px;
}

/* Settings */
.settings-section {
    background: var(--white);
    padding: 25px;
    border-radius: 12px;
    margin-bottom: 25px;
    box-shadow: var(--shadow);
}

.settings-grid {
    display: grid;
    gap: 20px;
}

/* Toast Notification */
.toast {
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--success);
    color: var(--white);
    padding: 16px 24px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    z-index: 2000;
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 600;
    transform: translateX(400px);
    transition: transform 0.3s;
}

.toast.show {
    transform: translateX(0);
}

.toast.error {
    background: var(--danger);
}

/* Export Preview */
.export-preview {
    background: #f5f5f5;
    padding: 20px;
    border-radius: 8px;
    margin-top: 20px;
    max-height: 400px;
    overflow-y: auto;
}

.export-preview pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 0.85em;
}

@media (max-width: 768px) {
    .admin-title {
        font-size: 1.2em;
    }
    
    .menu-items-grid {
        grid-template-columns: 1fr;
    }
    
    .image-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    }
    
    .modal-content {
        padding: 20px;
    }
}
</style>
</head>
<body>

<!-- Login Screen -->
<div class="login-container" id="loginScreen">
    <div class="login-box">
        <div class="login-logo">
            <img src="https://i.ibb.co/207VNnyn/dyufg.webp" alt="Logo">
            <h1>Admin Panel</h1>
            <p style="color: #666;">Cita Rasa Indonesia</p>
        </div>
        <div class="error-message" id="loginError">Username atau password salah!</div>
        <form onsubmit="handleLogin(event)">
            <div class="form-group">
                <label>üë§ Username</label>
                <input type="text" id="username" required autocomplete="username">
            </div>
            <div class="form-group">
                <label>üîí Password</label>
                <input type="password" id="password" required autocomplete="current-password">
            </div>
            <button type="submit" class="login-btn">üîê Login</button>
        </form>
    </div>
</div>

<!-- Admin Dashboard -->
<div class="admin-container" id="adminDashboard">
    <div class="admin-header">
        <div class="admin-header-content">
            <h1 class="admin-title">üõ†Ô∏è Admin Panel - Cita Rasa Indonesia</h1>
            <div class="admin-actions">
                <button class="btn btn-success" onclick="exportData()">üíæ Export Data</button>
                <button class="btn btn-secondary" onclick="previewWebsite()">üëÅÔ∏è Preview Website</button>
                <button class="btn btn-danger" onclick="logout()">üö™ Logout</button>
            </div>
        </div>
    </div>

    <div class="admin-content">
        <div class="section-tabs">
            <button class="tab-btn active" onclick="switchTab('menu')">üçΩÔ∏è Kelola Menu</button>
            <button class="tab-btn" onclick="switchTab('images')">üñºÔ∏è Kelola Gambar</button>
            <button class="tab-btn" onclick="switchTab('settings')">‚öôÔ∏è Pengaturan</button>
            <button class="tab-btn" onclick="switchTab('export')">üì§ Export/Import</button>
        </div>

        <!-- Menu Management Tab -->
        <div class="tab-content active" id="menuTab">
            <!-- Ricebowl Category -->
            <div class="menu-category">
                <div class="category-header">
                    <h3 class="category-title">‚ú® MENU RICEBOWL ‚ú®</h3>
                    <button class="btn btn-primary" onclick="openAddItemModal('ricebowl')">‚ûï Tambah Item</button>
                </div>
                <div class="menu-items-grid" id="ricebowlItems"></div>
            </div>

            <!-- Paket Spesial Category -->
            <div class="menu-category">
                <div class="category-header">
                    <h3 class="category-title">MENU PAKET SPESIAL</h3>
                    <button class="btn btn-primary" onclick="openAddItemModal('paket')">‚ûï Tambah Item</button>
                </div>
                <div class="menu-items-grid" id="paketItems"></div>
            </div>

            <!-- Prames Category -->
            <div class="menu-category">
                <div class="category-header">
                    <h3 class="category-title">MENU PRAMES</h3>
                    <button class="btn btn-primary" onclick="openAddItemModal('prames')">‚ûï Tambah Item</button>
                </div>
                <div class="menu-items-grid" id="pramesItems"></div>
            </div>

            <!-- Ala Carte Category -->
            <div class="menu-category">
                <div class="category-header">
                    <h3 class="category-title">MENU ALA CARTE</h3>
                    <button class="btn btn-primary" onclick="openAddItemModal('alacarte')">‚ûï Tambah Item</button>
                </div>
                <div class="menu-items-grid" id="alacarteItems"></div>
            </div>

            <!-- Seasonal Category -->
            <div class="menu-category">
                <div class="category-header">
                    <h3 class="category-title">MENU SEASONAL</h3>
                    <button class="btn btn-primary" onclick="openAddItemModal('seasonal')">‚ûï Tambah Item</button>
                </div>
                <div class="menu-items-grid" id="seasonalItems"></div>
            </div>
        </div>

        <!-- Images Management Tab -->
        <div class="tab-content" id="imagesTab">
            <div class="image-section">
                <div class="category-header">
                    <h3 class="category-title">üñºÔ∏è Logo & Header</h3>
                    <button class="btn btn-primary" onclick="openImageModal('logo')">‚úèÔ∏è Edit Logo</button>
                </div>
                <div class="image-grid" id="logoImages"></div>
            </div>

            <div class="image-section">
                <div class="category-header">
                    <h3 class="category-title">üì∏ Gallery Carousel</h3>
                    <button class="btn btn-primary" onclick="openImageModal('gallery')">‚ûï Tambah Gambar</button>
                </div>
                <div class="image-grid" id="galleryImages"></div>
            </div>

            <div class="image-section">
                <div class="category-header">
                    <h3 class="category-title">üçö Slider Ricebowl</h3>
                    <button class="btn btn-primary" onclick="openImageModal('ricebowl-slider')">‚ûï Tambah Gambar</button>
                </div>
                <div class="image-grid" id="ricebowlSliderImages"></div>
            </div>

            <div class="image-section">
                <div class="category-header">
                    <h3 class="category-title">üç± Gambar Prames</h3>
                    <button class="btn btn-primary" onclick="openImageModal('prames-image')">‚úèÔ∏è Edit Gambar</button>
                </div>
                <div class="image-grid" id="pramesImages"></div>
            </div>

            <div class="image-section">
                <div class="category-header">
                    <h3 class="category-title">ü•ò Slider Ala Carte</h3>
                    <button class="btn btn-primary" onclick="openImageModal('alacarte-slider')">‚ûï Tambah Gambar</button>
                </div>
                <div class="image-grid" id="alacarteSliderImages"></div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="tab-content" id="settingsTab">
            <div class="settings-section">
                <h3 class="category-title">‚öôÔ∏è Pengaturan Umum</h3>
                <div class="settings-grid">
                    <div class="form-group">
                        <label>Nama Restoran</label>
                        <input type="text" id="restaurantName" value="CITA RASA INDONESIA">
                    </div>
                    <div class="form-group">
                        <label>Subtitle</label>
                        <input type="text" id="subtitle" value="Authentic Indonesian Food">
                    </div>
                    <div class="form-group">
                        <label>Tagline</label>
                        <input type="text" id="tagline" value="MAKAN KENYANG, HATI SENANG, PIKIRAN TENANG!">
                    </div>
                    <div class="form-group">
                        <label>Link Telegram Admin</label>
                        <input type="text" id="telegramAdmin" value="https://t.me/CitaRasaIndo">
                    </div>
                    <div class="form-group">
                        <label>Link Telegram Channel</label>
                        <input type="text" id="telegramChannel" value="https://t.me/CriFood">
                    </div>
                    <div class="form-group">
                        <label>Pesan Footer</label>
                        <textarea id="footerMessage">Pesan sekarang dan nikmati kelezatan masakan Indonesia!</textarea>
                    </div>
                    <div class="form-group">
                        <label>Pesan Catering</label>
                        <textarea id="cateringMessage">üç± Menerima pesanan catering! Untuk acara kantor, ulang tahun, semua bisa! Pilih sendiri menu favoritmu, dari lauk sampai sambal, semuanya bisa disesuaikan!</textarea>
                    </div>
                    <button class="btn btn-success" onclick="saveSettings()">üíæ Simpan Pengaturan</button>
                </div>
            </div>

            <div class="settings-section">
                <h3 class="category-title">üîê Ubah Password</h3>
                <div class="settings-grid">
                    <div class="form-group">
                        <label>Password Lama</label>
                        <input type="password" id="oldPassword">
                    </div>
                    <div class="form-group">
                        <label>Password Baru</label>
                        <input type="password" id="newPassword">
                    </div>
                    <div class="form-group">
                        <label>Konfirmasi Password Baru</label>
                        <input type="password" id="confirmPassword">
                    </div>
                    <button class="btn btn-primary" onclick="changePassword()">üîí Ubah Password</button>
                </div>
            </div>
        </div>

        <!-- Export/Import Tab -->
        <div class="tab-content" id="exportTab">
            <div class="settings-section">
                <h3 class="category-title">üì§ Export Data</h3>
                <p style="margin-bottom: 20px; color: #666;">Download semua data menu dan pengaturan dalam format JSON</p>
                <button class="btn btn-success" onclick="downloadJSON()">üíæ Download JSON</button>
                <div class="export-preview" id="exportPreview"></div>
            </div>

            <div class="settings-section">
                <h3 class="category-title">üì• Import Data</h3>
                <p style="margin-bottom: 20px; color: #666;">Upload file JSON untuk mengembalikan data</p>
                <input type="file" id="importFile" accept=".json" style="margin-bottom: 15px;">
                <button class="btn btn-primary" onclick="importJSON()">üì• Import JSON</button>
            </div>

            <div class="settings-section">
                <h3 class="category-title">üîÑ Generate HTML</h3>
                <p style="margin-bottom: 20px; color: #666;">Generate file HTML lengkap dengan data terbaru</p>
                <button class="btn btn-secondary" onclick="generateHTML()">‚ö° Generate & Download HTML</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Item Modal -->
<div class="modal" id="itemModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">Edit Menu Item</h2>
            <button class="close-modal" onclick="closeModal('itemModal')">√ó</button>
        </div>
        <div class="form-grid">
            <input type="hidden" id="editCategory">
            <input type="hidden" id="editIndex">
            
            <div class="form-group">
                <label>Nama Menu</label>
                <input type="text" id="itemName" required>
            </div>
            
            <div class="form-group">
                <label>Harga (¬•)</label>
                <input type="number" id="itemPrice" required>
            </div>
            
            <div class="form-group">
                <label>Emoji</label>
                <input type="text" id="itemEmoji" placeholder="üçö">
            </div>
            
            <div class="form-group">
                <label>Keywords (pisahkan dengan spasi)</label>
                <input type="text" id="itemKeywords" placeholder="nasi ayam goreng">
            </div>
            
            <div class="form-group">
                <label>Ingredients / Items</label>
                <div class="ingredients-list" id="ingredientsList"></div>
                <button type="button" class="btn btn-secondary" onclick="addIngredientField()" style="margin-top: 10px;">‚ûï Tambah Item</button>
            </div>
        </div>
        
        <div class="form-actions">
            <button class="btn btn-secondary" onclick="closeModal('itemModal')">Batal</button>
            <button class="btn btn-success" onclick="saveMenuItem()">üíæ Simpan</button>
        </div>
    </div>
</div>

<!-- Image Modal -->
<div class="modal" id="imageModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="imageModalTitle">Edit Gambar</h2>
            <button class="close-modal" onclick="closeModal('imageModal')">√ó</button>
        </div>
        <div class="form-grid">
            <input type="hidden" id="imageCategory">
            <input type="hidden" id="imageIndex">
            
            <div class="form-group">
                <label>URL Gambar</label>
                <input type="text" id="imageUrl" placeholder="https://i.ibb.co/...">
            </div>
            
            <div class="form-group">
                <label>Alt Text</label>
                <input type="text" id="imageAlt" placeholder="Deskripsi gambar">
            </div>
            
            <div class="form-group">
                <label>Preview</label>
                <img id="imagePreview" src="" alt="Preview" style="width: 100%; max-height: 300px; object-fit: cover; border-radius: 8px; display: none;">
            </div>
        </div>
        
        <div class="form-actions">
            <button class="btn btn-secondary" onclick="closeModal('imageModal')">Batal</button>
            <button class="btn btn-success" onclick="saveImage()">üíæ Simpan</button>
        </div>
    </div>
</div>

<!-- Toast Notification -->
<div class="toast" id="toast">
    <span>‚úì</span>
    <span id="toastMessage">Success!</span>
</div>

<script>
// Default credentials (in production, use proper backend authentication)
const DEFAULT_CREDENTIALS = {
    username: 'admin',
    password: 'citarasa2024'
};

// Menu Data Structure
let menuData = {
    ricebowl: [
        { name: 'PARARI', price: 25, emoji: 'üçö', keywords: 'ricebowl nasi putih sambal teri telur ceplok timun', items: ['Nasi Putih', 'Sambal Teri', 'Telur Ceplok', 'Timun'] },
        { name: 'PARACU', price: 25, emoji: 'üçö', keywords: 'ricebowl nasi putih sambal cumi telur ceplok timun', items: ['Nasi Putih', 'Sambal Cumi', 'Telur Ceplok', 'Timun'] },
        { name: 'PARAKUS', price: 30, emoji: 'üçö', keywords: 'ricebowl nasi putih sambal cumi sambal teri telur ceplok timun', items: ['Nasi Putih', 'Sambal Cumi + Sambal Teri', 'Telur Ceplok', 'Timun'] },
        { name: 'PARABO', price: 23, emoji: 'üçö', keywords: 'ricebowl nasi putih sambal kentang balado telur ceplok timun', items: ['Nasi Putih', 'Sambal Kentang Balado', 'Telur Ceplok', 'Timun'] }
    ],
    paket: [
        { name: 'PAYALUR', price: 35, emoji: 'üçóüç≥ü•î', keywords: 'ayam goreng telur balado kentang balado bakwan', items: ['Nasi Putih dan Ayam Goreng', 'Telur Balado', 'Kentang Balado', 'Bakwan Sayur dan Sambal'] },
        { name: 'PAYALIT', price: 30, emoji: 'üçóü•î', keywords: 'ayam goreng kentang balado bakwan', items: ['Nasi Putih dan Ayam Goreng', 'Kentang Balado', 'Bakwan Sayur dan Sambal'] },
        { name: 'PAYAMAT', price: 25, emoji: 'üçó', keywords: 'ayam goreng bakwan', items: ['Nasi Putih dan Ayam Goreng', 'Bakwan Sayur dan Sambal'] },
        { name: 'PALUTANG', price: 25, emoji: 'üç≥ü•î', keywords: 'telur balado kentang balado bakwan', items: ['Nasi Putih dan Telur Balado', 'Kentang Balado', 'Bakwan Sayur 2pcs'] },
        { name: 'PALUR', price: 20, emoji: 'üç≥', keywords: 'telur balado bakwan', items: ['Nasi Putih dan Telur Balado', 'Bakwan Sayur 2pcs'] }
    ],
    prames: [
        { name: 'PRAMES A', price: 25, emoji: 'üç±', keywords: 'ayam goreng tahu timun sambal kremesan', items: ['Nasi Putih', 'Ayam Goreng', 'Tahu', 'Timun', 'Sambal', 'Kremesan'] },
        { name: 'PRAMES B', price: 33, emoji: 'üç±', keywords: 'ayam goreng telur balado tahu timun sambal kremesan', items: ['Nasi Putih', 'Ayam Goreng', 'Telur Balado', 'Tahu', 'Timun', 'Sambal', 'Kremesan'] },
        { name: 'PRAMES C', price: 30, emoji: 'üç±', keywords: 'ayam goreng kentang balado tahu timun sambal kremesan', items: ['Nasi Putih', 'Ayam Goreng', 'Kentang Balado', 'Tahu', 'Timun', 'Sambal', 'Kremesan'] },
        { name: 'PRAMES KARBO', price: 20, emoji: 'ü•î', keywords: 'kentang balado bakwan sambal kremesan', items: ['Nasi Putih', 'Kentang Balado', 'Bakwan 2pcs', 'Sambal', 'Kremesan'] },
        { name: 'PRAMES VEGGIE', price: 15, emoji: 'ü•¨', keywords: 'tahu timun sambal kremesan vegetarian', items: ['Nasi Putih', 'Tahu', 'Timun', 'Sambal', 'Kremesan'] }
    ],
    alacarte: [
        { name: 'Ayam Goreng', price: 15, emoji: '‚úö', keywords: 'ayam goreng chicken', items: ['Ayam Goreng'] },
        { name: 'Telur Dadar', price: 8, emoji: '‚úö', keywords: 'telur dadar omelet egg', items: ['Telur Dadar'] },
        { name: 'Kentang Balado', price: 10, emoji: '‚úö', keywords: 'kentang balado potato spicy', items: ['Kentang Balado'] },
        { name: 'Telur Balado', price: 10, emoji: '‚úö', keywords: 'telur balado egg spicy', items: ['Telur Balado'] },
        { name: 'Telur Ceplok', price: 7, emoji: '‚úö', keywords: 'telur ceplok fried egg', items: ['Telur Ceplok'] },
        { name: 'Bakwan 3pcs', price: 5, emoji: '‚úö', keywords: 'bakwan gorengan fritter', items: ['Bakwan 3pcs'] },
        { name: 'Extra Kremes', price: 5, emoji: '‚úö', keywords: 'kremes crispy topping', items: ['Extra Kremes'] },
        { name: 'Extra Sambel', price: 3, emoji: '‚úö', keywords: 'sambal sambel spicy sauce', items: ['Extra Sambel'] },
        { name: 'Eskopsus 100ml', price: 10, emoji: '‚úö', keywords: 'es kopi susu coffee milk drink', items: ['Eskopsus 100ml'] },
        { name: 'Eskopsus 200ml', price: 20, emoji: '‚úö', keywords: 'es kopi susu coffee milk drink', items: ['Eskopsus 200ml'] }
    ],
    seasonal: [
        { name: 'Sancodut', price: 15, emoji: 'üçåüç´', keywords: 'pisang cokelat gendut banana chocolate dessert', items: ['Pisang Cokelat Gendut', 'Isi 3pcs üçåüçåüçå', 'Susu Coklat or Susu Putih', 'Keju', 'Ceres'] }
    ]
};

// Images Data Structure
let imagesData = {
    logo: { url: 'https://i.ibb.co/207VNnyn/dyufg.webp', alt: 'Cita Rasa Indonesia Logo' },
    gallery: [
        { url: 'https://i.ibb.co/DD0PnmYT/7.png', alt: 'Menu 1' },
        { url: 'https://i.ibb.co/9mw135TC/8.png', alt: 'Menu 2' },
        { url: 'https://i.ibb.co/7JsKyyZm/2.png', alt: 'Menu 3' },
        { url: 'https://i.ibb.co/mCn6SZrS/3.png', alt: 'Menu 4' },
        { url: 'https://i.ibb.co/XfMg4Nby/4.png', alt: 'Menu 5' },
        { url: 'https://i.ibb.co/ZjZnPb2/5.png', alt: 'Menu 6' },
        { url: 'https://i.ibb.co/FqXW82DQ/6.png', alt: 'Menu 7' }
    ],
    ricebowlSlider: [
        { url: 'https://i.ibb.co/WpnMPdKP/Nih-buat-juga-kayak-yang-diatas-biar-senada-20251012-070811-0001.png', alt: 'Ricebowl 1' },
        { url: 'https://i.ibb.co/Wp772sxN/Nih-buat-juga-kayak-yang-diatas-biar-senada-20251012-070811-0000.png', alt: 'Ricebowl 2' }
    ],
    pramesImage: { url: 'https://i.ibb.co/DD0PnmYT/7.png', alt: 'Menu Prames' },
    alacarteSlider: [
        { url: 'https://i.ibb.co/7JsKyyZm/2.png', alt: 'Ala Carte 1' },
        { url: 'https://i.ibb.co/XfMg4Nby/4.png', alt: 'Ala Carte 2' },
        { url: 'https://i.ibb.co/FqXW82DQ/6.png', alt: 'Ala Carte 3' }
    ]
};

// Settings Data
let settingsData = {
    restaurantName: 'CITA RASA INDONESIA',
    subtitle: 'Authentic Indonesian Food',
    tagline: 'MAKAN KENYANG, HATI SENANG, PIKIRAN TENANG!',
    telegramAdmin: 'https://t.me/CitaRasaIndo',
    telegramChannel: 'https://t.me/CriFood',
    footerMessage: 'Pesan sekarang dan nikmati kelezatan masakan Indonesia!',
    cateringMessage: 'üç± Menerima pesanan catering! Untuk acara kantor, ulang tahun, semua bisa! Pilih sendiri menu favoritmu, dari lauk sampai sambal, semuanya bisa disesuaikan!'
};

// Initialize
window.addEventListener('DOMContentLoaded', () => {
    loadFromLocalStorage();
    checkAuth();
});

function loadFromLocalStorage() {
    const savedMenu = localStorage.getItem('citaRasaMenuData');
    const savedImages = localStorage.getItem('citaRasaImagesData');
    const savedSettings = localStorage.getItem('citaRasaSettings');
    
    if (savedMenu) menuData = JSON.parse(savedMenu);
    if (savedImages) imagesData = JSON.parse(savedImages);
    if (savedSettings) settingsData = JSON.parse(savedSettings);
}

function saveToLocalStorage() {
    localStorage.setItem('citaRasaMenuData', JSON.stringify(menuData));
    localStorage.setItem('citaRasaImagesData', JSON.stringify(imagesData));
    localStorage.setItem('citaRasaSettings', JSON.stringify(settingsData));
}

// Authentication
function checkAuth() {
    const isLoggedIn = sessionStorage.getItem('citaRasaAdminAuth');
    if (isLoggedIn === 'true') {
        showDashboard();
    }
}

function handleLogin(e) {
    e.preventDefault();
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const savedCredentials = JSON.parse(localStorage.getItem('citaRasaCredentials') || JSON.stringify(DEFAULT_CREDENTIALS));
    
    if (username === savedCredentials.username && password === savedCredentials.password) {
        sessionStorage.setItem('citaRasaAdminAuth', 'true');
        showDashboard();
    } else {
        document.getElementById('loginError').classList.add('show');
        setTimeout(() => {
            document.getElementById('loginError').classList.remove('show');
        }, 3000);
    }
}

function logout() {
    if (confirm('Yakin ingin logout?')) {
        sessionStorage.removeItem('citaRasaAdminAuth');
        location.reload();
    }
}

function showDashboard() {
    document.getElementById('loginScreen').style.display = 'none';
    document.getElementById('adminDashboard').classList.add('active');
    renderAllMenuItems();
    renderAllImages();
    loadSettings();
}

// Tab Switching
function switchTab(tabName) {
    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
    
    event.target.classList.add('active');
    document.getElementById(tabName + 'Tab').classList.add('active');
}

// Menu Item Management
function renderAllMenuItems() {
    Object.keys(menuData).forEach(category => {
        renderMenuItems(category);
    });
}

function renderMenuItems(category) {
    const container = document.getElementById(category + 'Items');
    if (!container) return;
    
    container.innerHTML = menuData[category].map((item, index) => `
        <div class="menu-item-card">
            <div class="item-header">
                <div class="item-name-price">
                    <h4>${item.emoji} ${item.name}</h4>
                    <span class="item-price-tag">¬•${item.price}</span>
                </div>
            </div>
            <div class="item-ingredients">
                ${item.items.map(i => `‚Ä¢ ${i}`).join('<br>')}
            </div>
            <div class="item-actions">
                <button class="btn btn-primary btn-small" onclick="editMenuItem('${category}', ${index})">‚úèÔ∏è Edit</button>
                <button class="btn btn-danger btn-small" onclick="deleteMenuItem('${category}', ${index})">üóëÔ∏è Hapus</button>
            </div>
        </div>
    `).join('');
}

function openAddItemModal(category) {
    document.getElementById('modalTitle').textContent = 'Tambah Menu Item';
    document.getElementById('editCategory').value = category;
    document.getElementById('editIndex').value = '';
    document.getElementById('itemName').value = '';
    document.getElementById('itemPrice').value = '';
    document.getElementById('itemEmoji').value = 'üçö';
    document.getElementById('itemKeywords').value = '';
    document.getElementById('ingredientsList').innerHTML = '';
    addIngredientField();
    document.getElementById('itemModal').classList.add('active');
}

function editMenuItem(category, index) {
    const item = menuData[category][index];
    document.getElementById('modalTitle').textContent = 'Edit Menu Item';
    document.getElementById('editCategory').value = category;
    document.getElementById('editIndex').value = index;
    document.getElementById('itemName').value = item.name;
    document.getElementById('itemPrice').value = item.price;
    document.getElementById('itemEmoji').value = item.emoji;
    document.getElementById('itemKeywords').value = item.keywords;
    
    const ingredientsList = document.getElementById('ingredientsList');
    ingredientsList.innerHTML = '';
    item.items.forEach(ingredient => {
        addIngredientField(ingredient);
    });
    
    document.getElementById('itemModal').classList.add('active');
}

function addIngredientField(value = '') {
    const container = document.getElementById('ingredientsList');
    const div = document.createElement('div');
    div.className = 'ingredient-item';
    div.innerHTML = `
        <input type="text" placeholder="Item ingredient..." value="${value}">
        <button type="button" class="btn btn-danger btn-icon" onclick="this.parentElement.remove()">√ó</button>
    `;
    container.appendChild(div);
}

function saveMenuItem() {
    const category = document.getElementById('editCategory').value;
    const index = document.getElementById('editIndex').value;
    const name = document.getElementById('itemName').value.trim();
    const price = parseFloat(document.getElementById('itemPrice').value);
    const emoji = document.getElementById('itemEmoji').value.trim();
    const keywords = document.getElementById('itemKeywords').value.trim();
    
    const ingredientInputs = document.querySelectorAll('#ingredientsList input');
    const items = Array.from(ingredientInputs)
        .map(input => input.value.trim())
        .filter(val => val !== '');
    
    if (!name || !price || items.length === 0) {
        showToast('Mohon isi semua field!', 'error');
        return;
    }
    
    const menuItem = { name, price, emoji, keywords, items };
    
    if (index === '') {
        menuData[category].push(menuItem);
    } else {
        menuData[category][parseInt(index)] = menuItem;
    }
    
    saveToLocalStorage();
    renderMenuItems(category);
    closeModal('itemModal');
    showToast('Menu item berhasil disimpan!');
}

function deleteMenuItem(category, index) {
    if (confirm('Yakin ingin menghapus item ini?')) {
        menuData[category].splice(index, 1);
        saveToLocalStorage();
        renderMenuItems(category);
        showToast('Menu item berhasil dihapus!');
    }
}

// Image Management
function renderAllImages() {
    renderLogoImage();
    renderGalleryImages();
    renderRicebowlSliderImages();
    renderPramesImage();
    renderAlacarteSliderImages();
}

function renderLogoImage() {
    const container = document.getElementById('logoImages');
    container.innerHTML = `
        <div class="image-card">
            <img src="${imagesData.logo.url}" alt="${imagesData.logo.alt}" class="image-preview">
            <div class="image-info">
                <div class="image-url">${imagesData.logo.url}</div>
                <div class="image-actions">
                    <button class="btn btn-primary btn-small" onclick="editImage('logo', -1)">‚úèÔ∏è Edit</button>
                </div>
            </div>
        </div>
    `;
}

function renderGalleryImages() {
    const container = document.getElementById('galleryImages');
    container.innerHTML = imagesData.gallery.map((img, index) => `
        <div class="image-card">
            <img src="${img.url}" alt="${img.alt}" class="image-preview">
            <div class="image-info">
                <div class="image-url">${img.url}</div>
                <div class="image-actions">
                    <button class="btn btn-primary btn-small" onclick="editImage('gallery', ${index})">‚úèÔ∏è Edit</button>
                    <button class="btn btn-danger btn-small" onclick="deleteImage('gallery', ${index})">üóëÔ∏è</button>
                </div>
            </div>
        </div>
    `).join('');
}

function renderRicebowlSliderImages() {
    const container = document.getElementById('ricebowlSliderImages');
    container.innerHTML = imagesData.ricebowlSlider.map((img, index) => `
        <div class="image-card">
            <img src="${img.url}" alt="${img.alt}" class="image-preview">
            <div class="image-info">
                <div class="image-url">${img.url}</div>
                <div class="image-actions">
                    <button class="btn btn-primary btn-small" onclick="editImage('ricebowlSlider', ${index})">‚úèÔ∏è Edit</button>
                    <button class="btn btn-danger btn-small" onclick="deleteImage('ricebowlSlider', ${index})">üóëÔ∏è</button>
                </div>
            </div>
        </div>
    `).join('');
}

function renderPramesImage() {
    const container = document.getElementById('pramesImages');
    container.innerHTML = `
        <div class="image-card">
            <img src="${imagesData.pramesImage.url}" alt="${imagesData.pramesImage.alt}" class="image-preview">
            <div class="image-info">
                <div class="image-url">${imagesData.pramesImage.url}</div>
                <div class="image-actions">
                    <button class="btn btn-primary btn-small" onclick="editImage('pramesImage', -1)">‚úèÔ∏è Edit</button>
                </div>
            </div>
        </div>
    `;
}

function renderAlacarteSliderImages() {
    const container = document.getElementById('alacarteSliderImages');
    container.innerHTML = imagesData.alacarteSlider.map((img, index) => `
        <div class="image-card">
            <img src="${img.url}" alt="${img.alt}" class="image-preview">
            <div class="image-info">
                <div class="image-url">${img.url}</div>
                <div class="image-actions">
                    <button class="btn btn-primary btn-small" onclick="editImage('alacarteSlider', ${index})">‚úèÔ∏è Edit</button>
                    <button class="btn btn-danger btn-small" onclick="deleteImage('alacarteSlider', ${index})">üóëÔ∏è</button>
                </div>
            </div>
        </div>
    `).join('');
}

function openImageModal(category) {
    document.getElementById('imageModalTitle').textContent = 'Tambah Gambar';
    document.getElementById('imageCategory').value = category;
    document.getElementById('imageIndex').value = '';
    document.getElementById('imageUrl').value = '';
    document.getElementById('imageAlt').value = '';
    document.getElementById('imagePreview').style.display = 'none';
    document.getElementById('imageModal').classList.add('active');
}

function editImage(category, index) {
    let image;
    if (category === 'logo' || category === 'pramesImage') {
        image = imagesData[category];
    } else {
        image = imagesData[category][index];
    }
    
    document.getElementById('imageModalTitle').textContent = 'Edit Gambar';
    document.getElementById('imageCategory').value = category;
    document.getElementById('imageIndex').value = index;
    document.getElementById('imageUrl').value = image.url;
    document.getElementById('imageAlt').value = image.alt;
    
    const preview = document.getElementById('imagePreview');
    preview.src = image.url;
    preview.style.display = 'block';
    
    document.getElementById('imageModal').classList.add('active');
}

document.getElementById('imageUrl').addEventListener('input', function() {
    const url = this.value.trim();
    const preview = document.getElementById('imagePreview');
    if (url) {
        preview.src = url;
        preview.style.display = 'block';
    } else {
        preview.style.display = 'none';
    }
});

function saveImage() {
    const category = document.getElementById('imageCategory').value;
    const index = parseInt(document.getElementById('imageIndex').value);
    const url = document.getElementById('imageUrl').value.trim();
    const alt = document.getElementById('imageAlt').value.trim();
    
    if (!url) {
        showToast('Mohon isi URL gambar!', 'error');
        return;
    }
    
    const imageData = { url, alt };
    
    if (category === 'logo' || category === 'pramesImage') {
        imagesData[category] = imageData;
    } else {
        if (index === -1 || isNaN(index)) {
            imagesData[category].push(imageData);
        } else {
            imagesData[category][index] = imageData;
        }
    }
    
    saveToLocalStorage();
    renderAllImages();
    closeModal('imageModal');
    showToast('Gambar berhasil disimpan!');
}

function deleteImage(category, index) {
    if (confirm('Yakin ingin menghapus gambar ini?')) {
        imagesData[category].splice(index, 1);
        saveToLocalStorage();
        renderAllImages();
        showToast('Gambar berhasil dihapus!');
    }
}

// Settings
function loadSettings() {
    document.getElementById('restaurantName').value = settingsData.restaurantName;
    document.getElementById('subtitle').value = settingsData.subtitle;
    document.getElementById('tagline').value = settingsData.tagline;
    document.getElementById('telegramAdmin').value = settingsData.telegramAdmin;
    document.getElementById('telegramChannel').value = settingsData.telegramChannel;
    document.getElementById('footerMessage').value = settingsData.footerMessage;
    document.getElementById('cateringMessage').value = settingsData.cateringMessage;
}

function saveSettings() {
    settingsData.restaurantName = document.getElementById('restaurantName').value;
    settingsData.subtitle = document.getElementById('subtitle').value;
    settingsData.tagline = document.getElementById('tagline').value;
    settingsData.telegramAdmin = document.getElementById('telegramAdmin').value;
    settingsData.telegramChannel = document.getElementById('telegramChannel').value;
    settingsData.footerMessage = document.getElementById('footerMessage').value;
    settingsData.cateringMessage = document.getElementById('cateringMessage').value;
    
    saveToLocalStorage();
    showToast('Pengaturan berhasil disimpan!');
}

function changePassword() {
    const oldPassword = document.getElementById('oldPassword').value;
    const newPassword = document.getElementById('newPassword').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    
    const savedCredentials = JSON.parse(localStorage.getItem('citaRasaCredentials') || JSON.stringify(DEFAULT_CREDENTIALS));
    
    if (oldPassword !== savedCredentials.password) {
        showToast('Password lama salah!', 'error');
        return;
    }
    
    if (newPassword !== confirmPassword) {
        showToast('Password baru tidak cocok!', 'error');
        return;
    }
    
    if (newPassword.length < 6) {
        showToast('Password minimal 6 karakter!', 'error');
        return;
    }
    
    savedCredentials.password = newPassword;
    localStorage.setItem('citaRasaCredentials', JSON.stringify(savedCredentials));
    
    document.getElementById('oldPassword').value = '';
    document.getElementById('newPassword').value = '';
    document.getElementById('confirmPassword').value = '';
    
    showToast('Password berhasil diubah!');
}

// Export/Import
function exportData() {
    const data = {
        menu: menuData,
        images: imagesData,
        settings: settingsData
    };
    document.getElementById('exportPreview').innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
}

function downloadJSON() {
    const data = {
        menu: menuData,
        images: imagesData,
        settings: settingsData
    };
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'citarasa-data-' + new Date().toISOString().split('T')[0] + '.json';
    a.click();
    showToast('Data berhasil didownload!');
}

function importJSON() {
    const file = document.getElementById('importFile').files[0];
    if (!file) {
        showToast('Pilih file JSON terlebih dahulu!', 'error');
        return;
    }
    
    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const data = JSON.parse(e.target.result);
            if (data.menu) menuData = data.menu;
            if (data.images) imagesData = data.images;
            if (data.settings) settingsData = data.settings;
            
            saveToLocalStorage();
            renderAllMenuItems();
            renderAllImages();
            loadSettings();
            
            showToast('Data berhasil diimport!');
        } catch (error) {
            showToast('File JSON tidak valid!', 'error');
        }
    };
    reader.readAsText(file);
}

function generateHTML() {
    // This would generate the complete HTML with updated data
    showToast('Generate HTML akan segera tersedia!');
}

// Utility Functions
function closeModal(modalId) {
    document.getElementById(modalId).classList.remove('active');
}

function showToast(message, type = 'success') {
    const toast = document.getElementById('toast');
    const toastMessage = document.getElementById('toastMessage');
    
    toastMessage.textContent = message;
    toast.className = 'toast ' + type;
    toast.classList.add('show');
    
    setTimeout(() => {
        toast.classList.remove('show');
    }, 3000);
}

function previewWebsite() {
    window.open('index.html', '_blank');
}

// Close modals when clicking outside
document.querySelectorAll('.modal').forEach(modal => {
    modal.addEventListener('click', function(e) {
        if (e.target === this) {
            closeModal(this.id);
        }
    });
});
</script>

</body>
</html>
